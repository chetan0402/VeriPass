syntax = "proto3";

package veripass.v1;

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "veripass/v1/pass.proto";

message Admin {
  string email = 1;
  string name = 2;
  string hostel = 3;
  bool can_add_pass = 4;
}

service AdminService {
  rpc GetAdmin(google.protobuf.Empty) returns (Admin);
  rpc GetAllPassesByHostel(GetAllPassesByHostelRequest) returns (GetAllPassesByHostelResponse);
  rpc GetPublicKey(google.protobuf.Empty) returns (GetPublicKeyResponse);
  rpc GetOutCountByHostel(GetOutCountByHostelRequest) returns (GetOutCountByHostelResponse);
}

message GetAllPassesByHostelRequest {
  string hostel = 1;
  google.protobuf.Timestamp start_time = 2;
  google.protobuf.Timestamp end_time = 3;
  optional bool pass_is_open = 4;
  Pass.PassType type = 5;
  int32 page_size = 6;
  google.protobuf.Timestamp page_token = 7; // Based on start_time
}

message GetAllPassesByHostelResponse {
  message InfoIncludedPass {
    Pass pass = 1;
    string student_name = 2;
    string student_room = 3;
  }
  repeated InfoIncludedPass passes = 1;
  google.protobuf.Timestamp next_page_token = 2;
}

message GetPublicKeyResponse {
  bytes public_key = 1;
}

message GetOutCountByHostelRequest {
  string hostel = 1;
  google.protobuf.Timestamp start_time = 2;
  google.protobuf.Timestamp end_time = 3;
  Pass.PassType type = 4;
}

message GetOutCountByHostelResponse {
  int64 out = 1;
}
